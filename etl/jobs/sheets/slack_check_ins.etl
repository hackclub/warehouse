require_relative '../../sources/sheets_source.rb'
require_relative '../../destinations/warehouse_destination.rb'

pre_process do
  $logger.info('Beginning Slack Check-Ins job')
end

source SheetsSource, $config[:slack_check_ins_spreadsheet_key]

transform do |row|
  row.delete(:club_leader_name)

  row
end

destination WarehouseDestination, $config[:database_url], :sheets__slack_check_ins, :id

post_process do
  $logger.info('Slack Check-Ins job successfully completed')
end
